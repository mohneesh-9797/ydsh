
# test complex module

function scriptName() : String {
    return "hello!!"
}

source ../../_module4test/module3.ds as mod

assert $mod.test($true, $mod.scriptName)! == $0

assert !$mod.test($false, $mod.scriptName)

echo ${$scriptName()} 1>&2
assert $mod.test($true, $scriptName)! == 'hello!!'

# script dir
assert $SCRIPT_DIR != $mod.path
assert $SCRIPT_DIR != $mod.dir()
assert $mod.path == $mod.path
assert $mod.path.endsWith('/exec/_module4test')

source ../../'_module4test/module4.ds' as mod1

assert $SCRIPT_DIR != $mod1.path
assert $SCRIPT_DIR != $mod1.dir()
assert $mod1.path == $mod1.dir()
assert $mod1.path == $mod1.mod3.path
assert $mod.path == $mod1.mod3.path