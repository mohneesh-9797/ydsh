
# invalid option
assert "$(ulimit -f hgoe 2>&1)" == "ydsh: ulimit: hgoe: invalid number"
ulimit -f hgoe
assert $? == 1

var expect =
"ydsh: ulimit: -X: invalid option
$(help -s ulimit)"

assert "$(ulimit -X 2>&1)" == $expect
assert !ulimit -X
assert $? == 2


# print resources
var opts = new [String]()
for $opt in "cdefilmnqrRstuvx" {
    ulimit -$opt && { $opts.add("-$opt"); true; }
}
assert "$(ulimit)" == "$(ulimit -f)"
assert "$(ulimit -S)" == "$(ulimit -f -S)"
assert "$(ulimit -H)" == "$(ulimit -f -H)"

# print all resources
assert "$(ulimit -a)" == "$(ulimit $opts)"
assert "$(ulimit -a -H)" == "$(ulimit $opts -H)"
assert "$(ulimit -a -S)" == "$(ulimit $opts -S)"

# change resource limit
assert ulimit -S -f 5000
assert "$(ulimit -S -f)" == '5000'
assert "$(ulimit -S -f -f unLimiTed)" == "unlimited"
assert "$(ulimit -S -f HarD -f)" == "$(ulimit -f -H)"

assert ulimit -H 5000
assert "$(ulimit -H)" == "5000"
assert !ulimit -S 6000
assert $? == 1
assert "$(ulimit -S 6000 2>&1)" ==
       "ydsh: ulimit: file size (blocks): cannot change limit: Invalid argument"

assert ulimit -S -f 4000
assert "$(ulimit -S -f)" == "4000"
assert ulimit -H -f sOft
assert "$(ulimit -H -f)" == "4000"
